<% provide(:title, 'Edit User') %>

<%= render partial: 'partials/breadcrumbs' %>

<div class="page__header">
  <div class="page__heading page__heading--actions">
    <div class="heading__main">
      <h2 class="heading__title">Edit User</h2>
    </div>

    <div class="heading__actions">
      <%= button_to account_path(@account), class: 'button--link link--danger link--icon font--bold', method: :delete, form: {
        data: {
          turbo: true,
          turbo_confirm: true,
          controller: 'turbo-confirm',
          turbo_confirm_title_value: 'Are your sure you want to delete this user?',
          turbo_confirm_body_value: 'You will not be able to undo this action.',
          turbo_confirm_button_text_value: "Delete User",
          turbo_confirm_alert_style_value: "danger" } } do %>

        <i class="fa-regular fa-trash-alt mr--3"></i>Delete User
      <% end %>

      <% if @account.masqueradable?(current_account) %>
        <%= link_to masquerade_path(@account), class: 'button button--stroke', data: { confirm: "Are you sure you want to log in as #{@account.first_name}?", subtext: 'Changes you make will take effect as if they did them.' } do %>
          <%# TODO: change once we have the concern/helper %>
          <i class="fa-regular fa-theater-masks mr--3"></i>Log in as <%= @account.first_name || @account.first_name_was %>
        <% end %>
      <% end %>
    </div>
  </div>
</div>

<%= simple_form_for @account, html: { class: 'page-sections', data: { turbo: false } } do |f| %>
  <div class="page-section">
    <div class="form-sidebar">
      <div class="form-sidebar__section">
        <h4 class="page-sidebar__title">User Information</h4>
        <%# TODO: change once we have the concern/helper %>
        <p>Manage <%= @account.first_name || @account.first_name_was %>'s personal information and contact details.</p>
        <p><%= @account.first_name || @account.first_name_was %> can also edit some of these details themselves via the My Profile page.</p>
      </div>
    </div>

    <div class="form-main">
      <div class="form-main__section">
        <div class="form__body">
          <div class="form__inputs">
            <%= f.input :name, label: 'Full Name', required: true, wrapper_html: { class: 'form__input--s2-m2-l6' }, icon_wrapper_html: { class: 'input-field--symbol fa-regular fa-user' }, hint: 'eg. Mr Smith, John Smith' %>
            <%= f.input :email, label: 'Email Address', required: true, wrapper_html: { class: 'form__input--s2-m2-l6' }, icon_wrapper_html: { class: 'input-field--symbol fa-regular fa-envelope' } %>
            <%= f.input :account_type, label: 'Type', required: true, wrapper_html: { class: 'form__input--s2-m2-l6' }, disabled: true %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="page-section page-section--actions">
    <div class="form__actions form__actions--section">
      <%= f.button :submit, value: 'Update User', class: 'button--success' %>
    </div>
  </div>
<% end %>
